<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Low-Pass Filters for Signal Processing - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{background:#fff;color:#333;display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{background-color:#eaffea;color:#55a532}.hljs-deletion{background-color:#ffecec;color:#bd2c00}.hljs-link{text-decoration:underline}.markdown-body{word-wrap:break-word;font-size:16px;line-height:1.5}.markdown-body:after,.markdown-body:before{content:"";display:table}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-bottom:16px;margin-top:0}.markdown-body hr{background-color:#e7e7e7;border:0;height:.25em;margin:24px 0;padding:0}.markdown-body blockquote{border-left:.25em solid #ddd;color:#777;font-size:16px;padding:0 1em}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb;color:#555;display:inline-block;font-size:11px;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{border-bottom:1px solid #eee;padding-bottom:.3em}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{color:#777;font-size:.85em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{list-style-type:none;padding:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0;margin-top:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:1em;font-style:italic;font-weight:700;margin-top:16px;padding:0}.markdown-body dl dd{margin-bottom:16px;padding:0 16px}.markdown-body table{display:block;overflow:auto;width:100%;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{border:1px solid #ddd;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{background-color:#fff;box-sizing:initial;max-width:100%}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{background-color:initial;max-width:none;vertical-align:text-top}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #ddd;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#0000000a;border-radius:3px;font-size:85%;margin:0;padding:.2em 0}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{content:"\00a0";letter-spacing:-.2em}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{background:#0000;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{background-color:#f7f7f7;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}.markdown-body pre code,.markdown-body pre tt{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{font-size:12px;line-height:1;overflow:hidden;padding:5px;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{background:#fff;border:0;padding:10px 8px 9px;text-align:right}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{background:#f8f8f8;border-top:0;font-weight:700}.news .alert .markdown-body blockquote{border:0;padding:0 0 0 40px}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{cursor:default!important;float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle}.markdown-body{max-width:758px;overflow:visible!important;padding-bottom:40px;padding-top:40px;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{border-right:3px solid #6ce26c!important;box-sizing:initial;color:#afafaf!important;cursor:default;display:inline-block;min-width:20px;padding:0 8px 0 0;position:relative;text-align:right;z-index:4}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-bottom:none;border-left:none;border-top:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-collapse:inherit!important;border-spacing:0}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{margin-bottom:unset;overflow:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p:last-child{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{background-color:inherit;border-radius:0;overflow:visible;text-align:center;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{height:100%;max-width:100%}.markdown-body pre>code.wrap{word-wrap:break-word;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap}.markdown-body .alert>p:last-child,.markdown-body .alert>ul:last-child{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{background-color:#000;background-position:50%;background-repeat:no-repeat;background-size:contain;cursor:pointer;display:table;overflow:hidden;text-align:center}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{object-fit:contain;width:100%;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{height:100%;left:0;position:absolute;top:0;width:100%}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{color:#fff;height:auto;left:50%;opacity:.3;position:absolute;top:50%;transform:translate(-50%,-50%);transition:opacity .2s;width:auto;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.figma{display:table;padding-bottom:56.25%;position:relative;width:100%}.figma iframe{border:1px solid #eee;bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.markmap-container{height:300px}.markmap-container>svg{height:100%;width:100%}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{color:#777;margin:25px auto -25px;max-width:760px;position:relative;z-index:2}.toc .invisable-node{list-style-type:none}.ui-toc{bottom:20px;position:fixed;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{border-bottom-left-radius:0;border-top-left-radius:0;height:40px;padding:10px 4px}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{color:#fff;opacity:1;transition:opacity .2s}.ui-toc-label:focus{background-color:#ccc;color:#000;opacity:.3}.ui-toc-label:hover{background-color:#ccc;opacity:1;transition:opacity .2s}.ui-toc-dropdown{margin-bottom:20px;margin-top:20px;max-height:70vh;max-width:45vw;overflow:auto;padding-left:10px;padding-right:10px;text-align:inherit;width:25vw}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{letter-spacing:.0029em;padding-right:0}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{color:#767676;display:block;font-size:13px;font-weight:500;padding:4px 20px}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{background-color:initial;border-left:1px solid #000;color:#000;padding-left:19px;text-decoration:none}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{border-left:none;border-right:1px solid #000;padding-right:19px}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{background-color:initial;border-left:2px solid #000;color:#000;font-weight:700;padding-left:18px}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{border-left:none;border-right:2px solid #000;padding-right:18px}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:30px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:40px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{font-weight:500;padding-left:28px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{font-weight:500;padding-left:38px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{max-height:70vh;max-width:15vw;overflow:auto;position:fixed;top:0}.back-to-top,.expand-toggle,.go-to-bottom{color:#999;display:block;font-size:12px;font-weight:500;margin-left:10px;margin-top:10px;padding:4px 10px}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{background-position:50%;background-repeat:no-repeat;background-size:cover;border-radius:50%;display:block;height:20px;margin-bottom:2px;margin-right:5px;margin-top:2px;width:20px}.ui-user-icon.small{display:inline-block;height:18px;margin:0 0 .2em;vertical-align:middle;width:18px}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;padding-left:22px;text-decoration:none}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}.inline-spoiler-section{cursor:pointer}.inline-spoiler-section .spoiler-text{background-color:#333;border-radius:2px}.inline-spoiler-section .spoiler-text>*{opacity:0}.inline-spoiler-section .spoiler-img{filter:blur(10px)}.inline-spoiler-section.raw{background-color:#333;border-radius:2px}.inline-spoiler-section.raw>*{opacity:0}.inline-spoiler-section.unveil{cursor:auto}.inline-spoiler-section.unveil .spoiler-text{background-color:#3333331a}.inline-spoiler-section.unveil .spoiler-text>*{opacity:1}.inline-spoiler-section.unveil .spoiler-img{filter:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{color:#222;position:relative;z-index:1}.markdown-body.slides:before{background-color:currentColor;bottom:0;box-shadow:0 0 0 50vw;content:"";display:block;left:0;position:absolute;right:0;top:0;z-index:-1}.markdown-body.slides section[data-markdown]{background-color:#fff;margin-bottom:1.5em;position:relative;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{left:1em;max-height:100%;overflow:hidden;position:absolute;right:1em;top:50%;transform:translateY(-50%)}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{border:3px solid #777;content:"";height:1.5em;position:absolute;right:1em;top:-1.5em}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}svg{text-shadow:none}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="false"><h1 id="Low-Pass-Filters-for-Signal-Processing" data-id="Low-Pass-Filters-for-Signal-Processing"><a class="anchor hidden-xs" href="#Low-Pass-Filters-for-Signal-Processing" title="Low-Pass-Filters-for-Signal-Processing"><span class="octicon octicon-link"></span></a><span>Low-Pass Filters for Signal Processing</span></h1><p><span>For most of the cases of our simulations, such as the dynamics initiated by non-ground states, there are multiple frequencies in the time-dependent properties and often the high-frequency oscilations give us unwanted noise. Here are two types of low-pass filters that you can use to handle this problem.</span></p><h2 id="sin4-rolling-low-pass-filter" data-id="sin4-rolling-low-pass-filter"><a class="anchor hidden-xs" href="#sin4-rolling-low-pass-filter" title="sin4-rolling-low-pass-filter"><span class="octicon octicon-link"></span></a><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>sin</mi><mn>4</mn></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 1.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.626em; height: 0px; font-size: 118%;"><span style="position: absolute; clip: rect(1.167em, 1001.626em, 2.262em, -999.998em); top: -2.152em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.215em, 1001.167em, 4.098em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.412em; left: 1.167em;"><span class="mn" id="MathJax-Span-5" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.156em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.04em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.127em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>sin</mi><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">\sin^4</script></span><span> rolling low-pass filter</span></h2><p><span>This window function has the parametric form:</span>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>sin</mi><mn>4</mn></msup><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mfrac><mrow><mi>&amp;#x03C0;</mi><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>&amp;#x2212;</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>t</mi><mn>0</mn></msub></mrow></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 13.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.171em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1011.119em, 3.589em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-10"><span class="mrow" id="MathJax-Span-11"><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-14" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-16" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-17" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-19" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-20" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-21" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-22"></span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">(</span><span class="mfrac" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 4.767em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1004.613em, 4.306em, -999.997em); top: -4.659em; left: 50%; margin-left: -2.303em;"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-27" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mo" id="MathJax-Span-28" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">(</span><span class="mi" id="MathJax-Span-29" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-30" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-31" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-32" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-33" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-34" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1003.384em, 4.306em, -999.997em); top: -3.327em; left: 50%; margin-left: -1.688em;"><span class="mrow" id="MathJax-Span-35"><span class="msubsup" id="MathJax-Span-36"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑑</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-43" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-44" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-46" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1004.767em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top-width: 1.3px; border-top-style: solid; width: 4.767em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-47" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-48" style="font-family: STIXGeneral-Regular;">,</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>sin</mi><mn>4</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>π</mi><mo>×</mo><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">w_{t_c}(t) = \sin^4(\frac{\pi\times(t-t_0)}{t_{end}-t_0}),</script></span>
<span>and then normalize it with:</span>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msubsup><mo>&amp;#x222B;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mn>0</mn></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow></msubsup><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mi>d</mi><mi>t</mi></mrow></mfrac></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-49" style="width: 11.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.224em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.027em, 1009.224em, 4.101em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-57" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-58" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-59" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-60" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-61" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mfrac" id="MathJax-Span-62" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 5.33em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1002.257em, 4.408em, -999.997em); top: -4.711em; left: 50%; margin-left: -1.176em;"><span class="mrow" id="MathJax-Span-63"><span class="msubsup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-70" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-73" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.871em, 1005.177em, 4.613em, -999.997em); top: -3.071em; left: 50%; margin-left: -2.61em;"><span class="mrow" id="MathJax-Span-74"><span class="msubsup" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px;"><span style="position: absolute; clip: rect(3.025em, 1000.617em, 4.46em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-76" style="font-family: STIXGeneral-Regular; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1001.078em, 4.255em, -999.997em); top: -4.557em; left: 0.771em;"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="msubsup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-84" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑛</span><span class="mi" id="MathJax-Span-85" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑑</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.617em, 4.255em, -999.997em); top: -3.635em; left: 0.464em;"><span class="texatom" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mn" id="MathJax-Span-90" style="font-size: 50%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-91" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-93"><span class="mrow" id="MathJax-Span-94"><span class="msubsup" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-96" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-97" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-98" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-99" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-100" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-101" style="font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral-Italic;">𝑡</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1005.33em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top-width: 1.3px; border-top-style: solid; width: 5.33em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mn>0</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow></msubsup><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">w_{t_c}(t) = \frac{w_{t_c}(t)}{\int^{t_{end}}_{t_0}w_{t_c}(t)dt}</script></span>
<span>where </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1001.488em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-104"><span class="msubsup" id="MathJax-Span-105"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span class="mi" id="MathJax-Span-111" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑑</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">t_{end}</script></span><span> and </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mn>0</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-112" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1000.771em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-113"><span class="msubsup" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-115" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">t_0</script></span><span> is within </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>c</mi></msub><mo>&amp;#x00B1;</mo><mn>0.5</mn><mo>&amp;#x00D7;</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" style="width: 8.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.867em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1006.816em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="msubsup" id="MathJax-Span-119"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-121" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-122" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">±</span><span class="mn" id="MathJax-Span-123" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">0.5</span><span class="mo" id="MathJax-Span-124" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mi" id="MathJax-Span-125" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑤</span><span class="mi" id="MathJax-Span-126" style="font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-128" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral-Italic;">ℎ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>c</mi></msub><mo>±</mo><mn>0.5</mn><mo>×</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">t_c\pm 0.5\times width</script></span><span>. It selects a period of </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>sin</mi><mn>4</mn></msup><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo>&amp;#x00D7;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-130" style="width: 5.638em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.613em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1004.562em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-131"><span class="msubsup" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-133" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-135"></span><span class="mo" id="MathJax-Span-136" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-137" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-138" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑥</span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>sin</mi><mn>4</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>π</mi><mo>×</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">\sin^4(\pi\times x)</script></span><span>, brodens it with the window width (</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>t</mi><mn>0</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 4.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1003.384em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑑</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-151" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-152" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-153" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">t_{end}-t_0</script></span><span>), and then shift it with </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mn>0</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-154" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1000.771em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="msubsup" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-157" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-158" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">t_0</script></span><span>. The following plot is the normalized</span><code>1fs</code><span>-window function centered at </span><code>4.83fs</code><span>.</span></p><figure>
    <img src="https://i.imgur.com/w41ckTs.png"><figcaption><center><i>Window function centered at around t<sub>c</sub>=4.83fs. </i></center></figcaption>
</figure><blockquote>
<p><span>Note that at the boundary of the signals, since </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>c</mi></msub><mo>&amp;#x00B1;</mo><mn>0.5</mn><mo>&amp;#x00D7;</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-159" style="width: 8.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.867em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1006.816em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-160"><span class="msubsup" id="MathJax-Span-161"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-162" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-164" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">±</span><span class="mn" id="MathJax-Span-165" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">0.5</span><span class="mo" id="MathJax-Span-166" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑤</span><span class="mi" id="MathJax-Span-168" style="font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-169" style="font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-171" style="font-family: STIXGeneral-Italic;">ℎ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>c</mi></msub><mo>±</mo><mn>0.5</mn><mo>×</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">t_c \pm 0.5\times width</script></span><span> will be out of the time range, there will be that </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>t</mi><mn>0</mn></msub><mo>&amp;lt;</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-172" style="width: 8.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.226em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1007.175em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-173"><span class="msubsup" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-175" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span class="mi" id="MathJax-Span-180" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑑</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-181" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-182" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mn" id="MathJax-Span-184" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-185" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">&lt;</span><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">𝑤</span><span class="mi" id="MathJax-Span-187" style="font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-188" style="font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-189" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-190" style="font-family: STIXGeneral-Italic;">ℎ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>−</mo><msub><mi>t</mi><mn>0</mn></msub><mo>&lt;</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">t_{end}-t_0 < width</script></span><span>.</span></p>
</blockquote><figure>
    <img src="https://i.imgur.com/HFwgnfm.png"><figcaption><center><i>Window function centered at t<sub>c</sub>=0 fs and around t<sub>c</sub>=4.83 fs. </i></center></figcaption>
</figure><p><span>By rolling over the time steps, this filter smooths the signal by masking the window </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.308em, 2.974em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-194" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="msubsup" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-199" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-200" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-201" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-202" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">w_{t_c}(t)</script></span><span> to the corresponding time signal:</span>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>f</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msubsup><mo>&amp;#x222B;</mo><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow></msubsup><msubsup><mo>&amp;#x222B;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mn>0</mn></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow></msubsup><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>c</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mi>d</mi><mi>t</mi><mo>,</mo></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-203" style="width: 17.216em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.091em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.873em, 1014.039em, 3.742em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-204"><span class="msup" id="MathJax-Span-205"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.617em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="mo" id="MathJax-Span-207" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-208" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-210" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-211" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-212" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 2.462em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1001.027em, 5.023em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-213" style="font-family: STIXIntegralsD; vertical-align: -0.612em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.464em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1001.232em, 4.255em, -999.997em); top: -5.12em; left: 1.232em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-217" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="texatom" id="MathJax-Span-218"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑚</span><span class="mi" id="MathJax-Span-221" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑎</span><span class="mi" id="MathJax-Span-222" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑥</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.412em, 4.152em, -999.997em); top: -3.071em; left: 0.566em;"><span class="mn" id="MathJax-Span-223" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-224" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1001.027em, 5.023em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-225" style="font-family: STIXIntegralsD; vertical-align: -0.612em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.464em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1001.078em, 4.255em, -999.997em); top: -5.12em; left: 1.232em;"><span class="texatom" id="MathJax-Span-226"><span class="mrow" id="MathJax-Span-227"><span class="msubsup" id="MathJax-Span-228"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="texatom" id="MathJax-Span-230"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-233" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑛</span><span class="mi" id="MathJax-Span-234" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑑</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.617em, 4.255em, -999.997em); top: -3.071em; left: 0.566em;"><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="msubsup" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mn" id="MathJax-Span-239" style="font-size: 50%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-240" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="msubsup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-246" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-247" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-248" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-249" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-250"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.617em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-251" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-256" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-258" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-259" style="font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-261" style="font-family: STIXGeneral-Regular;">,</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>f</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow></msubsup><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mn>0</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow></msubsup><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>c</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">f'(t) = \int^{t_{max}}_0\int^{t_{end}}_{t_0}w_{t_c}(t)f_{tc}(t)dt, </script></span>
<span>where </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>f</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-262" style="width: 2.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1001.949em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-263"><span class="msup" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.617em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-265" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.669em;"><span class="mo" id="MathJax-Span-266" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-268" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-269" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">f'(t)</script></span><span> is the filtered signal, it’s basically a convolution step without “conv” and this procudure is</span>
<span>like adding a Gaussian blur to the signal. Below is a gif shows how to get the filtered signal for </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>c</mi></msub><mo>=</mo><mn>190</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-270" style="width: 4.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.537em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1003.537em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-271"><span class="msubsup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-273" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-274" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-276" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">190</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>c</mi></msub><mo>=</mo><mn>190</mn></math></span></span><script type="math/tex" id="MathJax-Element-13">t_c=190</script></span><span> au.</span></p><figure>
    <img src="https://i.imgur.com/stvTinm.gif"><figcaption><center><i>Yellow dot denotes the chosen center t<sub>c</sub>. The filtered data is the integral of f(x)*w(x), which is the area under the purple curve.  </i></center></figcaption>
</figure><h4 id="How-it-is-implemented" data-id="How-it-is-implemented"><a class="anchor hidden-xs" href="#How-it-is-implemented" title="How-it-is-implemented"><span class="octicon octicon-link"></span></a><span>How it is implemented</span></h4><p><span>For a data set consist of </span><code>t[nt]</code><span>, </span><code>y[nt]</code><span>, do these steps for each time step:</span></p><ol>
<li><span>set this timestep as the center of the window, </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>c</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-277" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1000.72em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-280" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-281" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>c</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">t_c</script></span><span>.</span></li>
<li><span>find time steps </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-282" style="width: 2.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1002.41em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-283"><span class="msubsup" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-285" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span class="mi" id="MathJax-Span-289" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span><span class="mi" id="MathJax-Span-290" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑜</span><span class="mi" id="MathJax-Span-291" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span class="mi" id="MathJax-Span-292" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-15">t_{chosen}</script></span><span> that reside within </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi></mrow></msub><mo>&amp;#x00B1;</mo><mn>0.5</mn><mo>&amp;#x00D7;</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-294" style="width: 8.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.867em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1006.816em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-295"><span class="msubsup" id="MathJax-Span-296"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-297" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">±</span><span class="mn" id="MathJax-Span-302" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">0.5</span><span class="mo" id="MathJax-Span-303" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mi" id="MathJax-Span-304" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑤</span><span class="mi" id="MathJax-Span-305" style="font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-306" style="font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-307" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-308" style="font-family: STIXGeneral-Italic;">ℎ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi></mrow></msub><mo>±</mo><mn>0.5</mn><mo>×</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">t_{c} \pm0.5 \times width</script></span><span>. The corresponding data values are </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-309" style="width: 3.128em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.564em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1002.564em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-310"><span class="msubsup" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.515em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-312" style="font-family: STIXGeneral-Italic;">𝑦</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑜</span><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-320" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">y_{chosen}</script></span><span>.</span></li>
<li><span>calculate this window function with </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-321" style="width: 2.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1002.41em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-322"><span class="msubsup" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-324" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span class="mi" id="MathJax-Span-328" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑜</span><span class="mi" id="MathJax-Span-330" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-332" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">t_{chosen}</script></span><span>. </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>sin</mi><mn>4</mn></msup><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mfrac><mrow><mi>&amp;#x03C0;</mi><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>&amp;#x2212;</mo><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-333" style="width: 18.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.166em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1015.115em, 3.537em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-334"><span class="msubsup" id="MathJax-Span-335"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-336" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="msubsup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-340" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-341" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-342" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-343" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-344" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-345" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-346" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-347" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-348" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-349"></span><span class="mo" id="MathJax-Span-350" style="font-family: STIXGeneral-Regular;">(</span><span class="mfrac" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 9.019em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1007.38em, 4.306em, -999.997em); top: -4.659em; left: 50%; margin-left: -3.686em;"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-354" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mo" id="MathJax-Span-355" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">(</span><span class="mi" id="MathJax-Span-356" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-357" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-358" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-359" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-360"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span class="mi" id="MathJax-Span-363" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑜</span><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span class="mi" id="MathJax-Span-366" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-367" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-368" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-369" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-370" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-371" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1008.814em, 4.306em, -999.997em); top: -3.327em; left: 50%; margin-left: -4.454em;"><span class="mrow" id="MathJax-Span-372"><span class="msubsup" id="MathJax-Span-373"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-374" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-375"><span class="mrow" id="MathJax-Span-376"><span class="mi" id="MathJax-Span-377" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span class="mi" id="MathJax-Span-378" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑜</span><span class="mi" id="MathJax-Span-380" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-382" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-383" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-384" style="font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-385" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-386" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-387" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-388" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-389" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="texatom" id="MathJax-Span-390"><span class="mrow" id="MathJax-Span-391"><span class="mi" id="MathJax-Span-392" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span class="mi" id="MathJax-Span-393" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span><span class="mi" id="MathJax-Span-394" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑜</span><span class="mi" id="MathJax-Span-395" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-397" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-398" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-399" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-400" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1009.019em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top-width: 1.3px; border-top-style: solid; width: 9.019em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-401" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>sin</mi><mn>4</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>π</mi><mo>×</mo><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><mrow><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>−</mo><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">w_{t_c}(t) = \sin^4(\frac{\pi\times(t-t_{chosen}[0])}{t_{chosen}[-1]-t_{chosen}[0]})</script></span></li>
<li><span>normalize the window by the sum of the window elements.</span></li>
<li><span>do dot production </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-402" style="width: 6.97em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.689em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1005.689em, 2.974em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-403"><span class="msubsup" id="MathJax-Span-404"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-405" style="font-family: STIXGeneral-Italic;">𝑤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-406"><span class="mrow" id="MathJax-Span-407"><span class="msubsup" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.207em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-409" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.207em;"><span class="mi" id="MathJax-Span-410" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-411" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-412" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-413" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-414" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⋅</span><span class="msubsup" id="MathJax-Span-415" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.515em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-416" style="font-family: STIXGeneral-Italic;">𝑦</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-417"><span class="mrow" id="MathJax-Span-418"><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span class="mi" id="MathJax-Span-420" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑜</span><span class="mi" id="MathJax-Span-422" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span class="mi" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑒</span><span class="mi" id="MathJax-Span-424" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>c</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>h</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">w_{t_c}(t) \cdot y_{chosen}</script></span><span> and then sum these elements(convolution step). The sum will be the filtered value for this time step.</span></li>
</ol><p><span>The plots below are the dipole moment filtered with the </span><code>1fs</code><span>-</span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>sin</mi><mn>4</mn></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-425" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1001.642em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-426"><span class="msubsup" id="MathJax-Span-427"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-428" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-429" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>sin</mi><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-21">\sin^4</script></span><span> window. The first plot is generated by filtering </span><code>12fs</code><span>signal, while the second is the comparision between filtering over </span><code>4fs</code><span> and </span><code>12fs</code><span> signal. It can be seen that the “head” and “tail” of the filtered signal are not reliable. It’s always a good idea to have a larger signal set to get good results.</span></p><blockquote>
<p><span>Note that there is no strict relationship between the signal length and window width. As long as the cutoff energy is above your main frequency (what you want to keep), the filtering in principle will work, and thus you need to play around to get the optimized signal length.</span></p>
</blockquote><p><span>The cutoff frequency of this filter is actually not determined. One reason is that the width of the window changes over </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>t</mi><mi>c</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-430" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1000.72em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-431"><span class="msubsup" id="MathJax-Span-432"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-433" style="font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.31em;"><span class="mi" id="MathJax-Span-434" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>c</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">t_c</script></span><span>. Also, for a rectangular filter, the cutoff angular frequency is </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mn>2</mn><mi>&amp;#x03C0;</mi></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-435" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1002.103em, 2.769em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-436"><span class="mfrac" id="MathJax-Span-437"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -4.403em; left: 50%; margin-left: -0.356em;"><span class="mrow" id="MathJax-Span-438"><span class="mn" id="MathJax-Span-439" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.693em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.868em;"><span class="mrow" id="MathJax-Span-441"><span class="mi" id="MathJax-Span-442" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑤</span><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-445" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1001.847em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top-width: 1.3px; border-top-style: solid; width: 1.847em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mn>2</mn><mi>π</mi></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-23">\frac{2\pi}{width}</script></span><span>, therefore, for the </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>sin</mi><mn>4</mn></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-447" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1001.642em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="msubsup" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-450" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-451" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>sin</mi><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-24">\sin^4</script></span><span> shape filter, the cutoff angular frequency is </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mn>2</mn><mi>&amp;#x03C0;</mi></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac><mo>&amp;#x00D7;</mo><mi>c</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-452" style="width: 4.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1003.691em, 3.128em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-453"><span class="mfrac" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -4.403em; left: 50%; margin-left: -0.356em;"><span class="mrow" id="MathJax-Span-455"><span class="mn" id="MathJax-Span-456" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-457" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.693em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.868em;"><span class="mrow" id="MathJax-Span-458"><span class="mi" id="MathJax-Span-459" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑤</span><span class="mi" id="MathJax-Span-460" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-462" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1001.847em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top-width: 1.3px; border-top-style: solid; width: 1.847em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-464" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mi" id="MathJax-Span-465" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑐</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mn>2</mn><mi>π</mi></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac><mo>×</mo><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">\frac{2\pi}{width}\times c</script></span><span>, where </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;lt;</mo><mi>c</mi><mo>&amp;lt;</mo><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-466" style="width: 5.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.101em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1004.05em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-467"><span class="mn" id="MathJax-Span-468" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-469" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">&lt;</span><span class="mi" id="MathJax-Span-470" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">𝑐</span><span class="mo" id="MathJax-Span-471" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">&lt;</span><span class="mn" id="MathJax-Span-472" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>&lt;</mo><mi>c</mi><mo>&lt;</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-26">1<c<2</script></span><span>. But still, we can use </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mn>2</mn><mi>&amp;#x03C0;</mi></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-473" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1002.103em, 2.769em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-474"><span class="mfrac" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.384em, 1000.771em, 4.152em, -999.997em); top: -4.403em; left: 50%; margin-left: -0.356em;"><span class="mrow" id="MathJax-Span-476"><span class="mn" id="MathJax-Span-477" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-478" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.693em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.868em;"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑤</span><span class="mi" id="MathJax-Span-481" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-482" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑑</span><span class="mi" id="MathJax-Span-483" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span class="mi" id="MathJax-Span-484" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℎ</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1001.847em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top-width: 1.3px; border-top-style: solid; width: 1.847em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mn>2</mn><mi>π</mi></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-27">\frac{2\pi}{width}</script></span><span> to approximate the cutoff energy (remember to convert the unit of width into </span><code>au</code><span> if it’s </span><code>fs</code><span>).</span>
<img src="https://i.imgur.com/smeGQYf.png" alt="" loading="lazy"></p><h2 id="Butterworth-filter" data-id="Butterworth-filter"><a class="anchor hidden-xs" href="#Butterworth-filter" title="Butterworth-filter"><span class="octicon octicon-link"></span></a><span>Butterworth filter</span></h2><p><a href="https://en.wikipedia.org/wiki/Butterworth_filter" target="_blank" rel="noopener"><span>Butterworth</span></a><span> is a more versatile filter that cannot only enable low-pass but also high-pass and band-pass by specifying the cutoff energies.</span></p><figure>
<img src="https://i.imgur.com/WyyeJ9F.png">
<figcaption><i>The blue solid line, orange dashed line, and green solid line shows the frequency response of a 10 evlow-pass filter, a 10~20 ev band-pass and a 20 ev high-pass filter, respectively. </i></figcaption>
</figure><h4 id="How-it-is-implemented1" data-id="How-it-is-implemented"><a class="anchor hidden-xs" href="#How-it-is-implemented1" title="How-it-is-implemented1"><span class="octicon octicon-link"></span></a><span>How it is implemented</span></h4><p><span>Butterworth filter has well-developed libaray in both python Scipy library and Matlab. It basically has two steps, taking the Scipy.signal as example:</span></p><ol>
<li>
<p><span>calculate the transfer function coefficients </span><code>a</code><span> and </span><code>b</code><span>:</span></p>
<p><code>b, a = scipy.signal.butter(order, cutoff, btype='low', analog=False, output='ba', fs=fs)</code></p>
<p><code>order</code><span>: the order of the butterworth filter. The higher the order, the steeper the transition band slope. Typically set as 5 or 6.</span>
<code>cutoff</code><span>: the cutoff energy</span>
<code>btype</code><span>: the type of the butterworth filter (‘low’ or ‘high’ or ‘band’)</span>
<code>analog</code><span>: if it’s an analog filter. It’s digital filter in our case so set to false.</span>
<code>output</code><span>: set to ‘ba’ so that returns the </span><code>a</code><span>,</span><code>b</code><span> coefficients</span>
<code>fs</code><span>: sampling frequency. Note the unit has to be the same as cutoff energy (both Hz or both rad/s)</span></p>
<p><span>You can check the frequency response by using </span><code>freqz</code><span>:</span></p>
<p><code>l, h = scipy.signal.freqz(b, a, fs=fs, worN=2000)</code></p>
</li>
<li>
<p><span>do the convolution with </span><code>filtfilt</code><span> method</span></p>
<p><code> y = scipy.signal.filtfilt(b, a, unfiltered_y)</code></p>
</li>
</ol><p><span>Same as the </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>sin</mi><mn>4</mn></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-485" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1001.642em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-486"><span class="msubsup" id="MathJax-Span-487"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-488" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-489" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>sin</mi><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-28">\sin^4</script></span><span> window, the “head” and “tail” of the filtered signal is not reliable. Therefore it’s always to use a larger signal set than the desired one. The following plot shows the filtered </span><code>12fs </code><span>and </span><code>4fs</code><span> signal using a </span><code>4eV</code><span> butterworth filter.</span>
<img src="https://i.imgur.com/pYufQGH.png" alt="" loading="lazy"></p><p><span>The plot below shows the filtered </span><code>12fs </code><span>signal using </span><code>4ev</code><span> butterworth and </span><code>1fs</code><span> </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>sin</mi><mn>4</mn></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-490" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1001.642em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-491"><span class="msubsup" id="MathJax-Span-492"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-493" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-494" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>sin</mi><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-29">\sin^4</script></span><span> filter. These two filters give almost the same filtered signal except at the beginneg and end of the signal.</span>
<img src="https://i.imgur.com/QYQ4Tc6.png" alt="" loading="lazy"></p><h2 id="Conclusion" data-id="Conclusion"><a class="anchor hidden-xs" href="#Conclusion" title="Conclusion"><span class="octicon octicon-link"></span></a><span>Conclusion</span></h2><p><span>Both </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>sin</mi><mn>4</mn></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-495" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1001.642em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-496"><span class="msubsup" id="MathJax-Span-497"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-498" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-499" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>sin</mi><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-30">\sin^4</script></span><span> and Butterworth filter can be applied to remove the high-frequency signal around cutoff energy using convolution. However, I’d prefer the Butterworth filter since it has determinate cutoff energy and is more intuitive to use. When applying these filters to volumetric data, testig on the 2d dipole signal to find the optimized time range is always a good idea.</span></p><h2 id="References" data-id="References"><a class="anchor hidden-xs" href="#References" title="References"><span class="octicon octicon-link"></span></a><span>References</span></h2><ol>
<li><span>useful information about how Butterworth is implemented:</span>
<a href="https://www.mathworks.com/help/signal/ref/butter.html" target="_blank" rel="noopener"><span>https://www.mathworks.com/help/signal/ref/butter.html</span></a></li>
<li><span>explanation of what filtfilt actually does:</span>
<a href="https://stackoverflow.com/questions/60707699/what-actually-are-the-transfer-functions-in-filtfilt-matlabs-zero-offset-filte" target="_blank" rel="noopener"><span>https://stackoverflow.com/questions/60707699/what-actually-are-the-transfer-functions-in-filtfilt-matlabs-zero-offset-filte</span></a></li>
<li><span>explanation of filtfilt and transfer function coefficients:</span>
<a href="https://www.mathworks.com/help/signal/ref/filtfilt.html" target="_blank" rel="noopener"><span>https://www.mathworks.com/help/signal/ref/filtfilt.html</span></a></li>
<li><span>example codes and units explanation of the Butterworth filter:</span>
<a href="https://stackoverflow.com/questions/25191620/creating-lowpass-filter-in-scipy-understanding-methods-and-units" target="_blank" rel="noopener"><span>https://stackoverflow.com/questions/25191620/creating-lowpass-filter-in-scipy-understanding-methods-and-units</span></a></li>
<li><span>other low-pass filter: moving average</span>
<a href="https://dsp.stackexchange.com/questions/49174/a-basic-question-about-the-use-of-moving-average-vs-low-pass-filters-in-dsp" target="_blank" rel="noopener"><span>https://dsp.stackexchange.com/questions/49174/a-basic-question-about-the-use-of-moving-average-vs-low-pass-filters-in-dsp</span></a></li>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>sin</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-500" style="width: 1.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.232em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-501"><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral-Regular;">sin</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>sin</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">\sin</script></span><span> and power of </span><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>sin</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-503" style="width: 1.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.232em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: STIXGeneral-Regular;">sin</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>sin</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">\sin</script></span><span> window</span>
<a href="https://en.wikipedia.org/wiki/List_of_window_functions#Power-of-sine/cosine_windows" target="_blank" rel="noopener"><span>https://en.wikipedia.org/wiki/List_of_window_functions#Power-of-sine/cosine_windows</span></a></li>
</ol></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#Low-Pass-Filters-for-Signal-Processing" title="Low-Pass Filters for Signal Processing">Low-Pass Filters for Signal Processing</a><ul class="nav">
<li><a href="#sin4-rolling-low-pass-filter" title="sin4sin4\sin^4 rolling low-pass filter">sin4" role="presentation" style="font-size: 115%; position: relative;"&gt;sin4sin4\sin^4 rolling low-pass filter</a><ul class="nav">
<li><a href="#How-it-is-implemented" title="How it is implemented">How it is implemented</a></li>
</ul>
</li>
<li><a href="#Butterworth-filter" title="Butterworth filter">Butterworth filter</a><ul class="nav">
<li><a href="#How-it-is-implemented1" title="How it is implemented">How it is implemented</a></li>
</ul>
</li>
<li><a href="#Conclusion" title="Conclusion">Conclusion</a></li>
<li><a href="#References" title="References">References</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Low-Pass-Filters-for-Signal-Processing" title="Low-Pass Filters for Signal Processing">Low-Pass Filters for Signal Processing</a><ul class="nav">
<li class=""><a href="#sin4-rolling-low-pass-filter" title="sin4sin4\sin^4 rolling low-pass filter">sin4" role="presentation" style="font-size: 115%; position: relative;"&gt;sin4sin4\sin^4 rolling low-pass filter</a><ul class="nav">
<li class=""><a href="#How-it-is-implemented" title="How it is implemented">How it is implemented</a></li>
</ul>
</li>
<li class=""><a href="#Butterworth-filter" title="Butterworth filter">Butterworth filter</a><ul class="nav">
<li class=""><a href="#How-it-is-implemented1" title="How it is implemented">How it is implemented</a></li>
</ul>
</li>
<li><a href="#Conclusion" title="Conclusion">Conclusion</a></li>
<li><a href="#References" title="References">References</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
